import{S as G,i as K,s as Y,k as j,l as H,m as L,h as k,a0 as x,n as C,b as Q,E as te,T as q,Y as ne,I as V,a1 as ae,$ as oe,o as se,w as I,x as A,y as R,f as z,t as N,z as F,Z as re,W,a as Z,c as J,F as le,X as O,_ as fe}from"../../../chunks/paths-34b7d8a7.js";import{m as ie,c as ue,o as ce,L as he,C as de,S as me,t as $,i as ge,T as _e,M as we}from"../../../chunks/detector-698e2f7b.js";import{_ as ve}from"../../../chunks/preload-helper-aa6bc0ce.js";function be(i){let t,e,a,r;return{c(){t=j("div"),e=j("video"),this.h()},l(s){t=H(s,"DIV",{class:!0});var l=L(t);e=H(l,"VIDEO",{src:!0,width:!0,height:!0}),L(e).forEach(k),l.forEach(k),this.h()},h(){x(e.src,a=`https://alg.halftime.fit/videos/${i[5][i[4]].name}.mp4`)||C(e,"src",a),C(e,"width",i[1]),C(e,"height",i[2]),e.autoplay=!0,e.muted=!0,e.playsInline=!0,e.controls=!0,e.loop=!0,C(t,"class",r=`${i[0]||""}`)},m(s,l){Q(s,t,l),te(t,e),i[6](e)},p(s,[l]){l&16&&!x(e.src,a=`https://alg.halftime.fit/videos/${s[5][s[4]].name}.mp4`)&&C(e,"src",a),l&2&&C(e,"width",s[1]),l&4&&C(e,"height",s[2]),l&1&&r!==(r=`${s[0]||""}`)&&C(t,"class",r)},i:q,o:q,d(s){s&&k(t),i[6](null)}}}function Ce(i,t,e){let a;ne(i,ie,h=>e(4,a=h));let r,{class:s}=t,{width:l}=t,{height:w}=t;const f=[{name:"\u9ACB\u94F0\u94FE\u8FD0\u52A8",value:0},{name:"\u7AD9\u7ACB\u540E\u7F29\u4E0B\u5DF4\u53CC\u81C2\u4E0A\u62AC\u89E6\u5899",value:1},{name:"\u9ACB\u94F0\u94FE\u8FD0\u52A8",value:2}];function c(h){V[h?"unshift":"push"](()=>{r=h,e(3,r)})}return i.$$set=h=>{"class"in h&&e(0,s=h.class),"width"in h&&e(1,l=h.width),"height"in h&&e(2,w=h.height)},[s,l,w,r,a,f,c]}class pe extends G{constructor(t){super(),K(this,t,Ce,be,Y,{class:0,width:1,height:2})}}function ye(i){let t,e,a;return{c(){t=j("div"),this.h()},l(r){t=H(r,"DIV",{style:!0,class:!0}),L(t).forEach(k),this.h()},h(){C(t,"style",i[0]),C(t,"class","m-0")},m(r,s){Q(r,t,s),e||(a=ae(i[1].call(null,t)),e=!0)},p(r,[s]){s&1&&C(t,"style",r[0])},i:q,o:q,d(r){r&&k(t),e=!1,a()}}}function ke(i,t){return t.forEach(([e,a])=>i[e]=a),i}function Me(i,t,e){let{target:a=void 0}=t,{sketch:r=void 0}=t,{parentDivStyle:s="display: block;"}=t,{debug:l=!1}=t,w;const f=oe(),c={ref(){f("ref",a)},instance(){f("instance",w)}};function h(u){return e(2,a=u),{destroy(){e(2,a=void 0)}}}return se(async()=>{const u=await ve(()=>import("../../../chunks/p5.min-2c911239.js").then(m=>m.p),["../../../chunks/p5.min-2c911239.js","../../../chunks/detector-698e2f7b.js","../../../chunks/paths-34b7d8a7.js","../../../chunks/Icon-e5a3e5d7.js","../../../assets/Icon-17239937.css"],import.meta.url),{default:n}=u,g=Object.entries(u).filter(([m,p])=>p instanceof Function&&m[0]!=="_"&&m!=="default");l&&console.log("available p5 native classes",g),w=new n(m=>(m=ke(m,g),l&&console.log("p5 instance",m),window._p5Instance=m,r(m)),a),c.ref(),c.instance()}),i.$$set=u=>{"target"in u&&e(2,a=u.target),"sketch"in u&&e(3,r=u.sketch),"parentDivStyle"in u&&e(0,s=u.parentDivStyle),"debug"in u&&e(4,l=u.debug)},[s,h,a,r,l]}class Ee extends G{constructor(t){super(),K(this,t,Me,ye,Y,{target:2,sketch:3,parentDivStyle:0,debug:4})}}function De(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function ee(i,t){for(var e=0;e<t.length;e++){var a=t[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}function Pe(i,t,e){return t&&ee(i.prototype,t),e&&ee(i,e),i}/**
* KalmanFilter
* @class
* @author Wouter Bulten
* @see {@link http://github.com/wouterbulten/kalmanjs}
* @version Version: 1.0.0-beta
* @copyright Copyright 2015-2018 Wouter Bulten
* @license MIT License
* @preserve
*/var Se=function(){function i(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.R,a=e===void 0?1:e,r=t.Q,s=r===void 0?1:r,l=t.A,w=l===void 0?1:l,f=t.B,c=f===void 0?0:f,h=t.C,u=h===void 0?1:h;De(this,i),this.R=a,this.Q=s,this.A=w,this.C=u,this.B=c,this.cov=NaN,this.x=NaN}return Pe(i,[{key:"filter",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(isNaN(this.x))this.x=1/this.C*e,this.cov=1/this.C*this.Q*(1/this.C);else{var r=this.predict(a),s=this.uncertainty(),l=s*this.C*(1/(this.C*s*this.C+this.Q));this.x=r+l*(e-this.C*r),this.cov=s-l*this.C*s}return this.x}},{key:"predict",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.A*this.x+this.B*e}},{key:"uncertainty",value:function(){return this.A*this.cov*this.A+this.R}},{key:"lastMeasurement",value:function(){return this.x}},{key:"setMeasurementNoise",value:function(e){this.Q=e}},{key:"setProcessNoise",value:function(e){this.R=e}}]),i}(),Ie=Se;function Ae(i){let t,e,a,r;return e=new Ee({props:{sketch:i[1]}}),{c(){t=j("div"),I(e.$$.fragment),this.h()},l(s){t=H(s,"DIV",{class:!0});var l=L(t);A(e.$$.fragment,l),l.forEach(k),this.h()},h(){C(t,"class",a=`${i[0]||""}`)},m(s,l){Q(s,t,l),R(e,t,null),r=!0},p(s,[l]){(!r||l&1&&a!==(a=`${s[0]||""}`))&&C(t,"class",a)},i(s){r||(z(e.$$.fragment,s),r=!0)},o(s){N(e.$$.fragment,s),r=!1},d(s){s&&k(t),F(e)}}}function Re(i,t,e){const a=new Ie({R:.01,Q:1});let r,{class:s}=t,{width:l,height:w}=t,{pose:f}=t,{pose3d:c}=t,h=0;const u=n=>{function b(g,m){var p=n.color(g);return n.color("rgba("+[n.red(p),n.green(p),n.blue(p),m].join(",")+")")}n.setup=()=>{n.createCanvas(l,w)},n.draw=()=>{n.background(255,50);const g=n.width/2,m=n.height/2;n.radians(10);const p=n.width/3,B=20,E=20;if(r){n.push();const S={x:g*1.5,y:m/2};n.translate(S.x,S.y),n.strokeWeight(5),r.keypoints.forEach(y=>{n.stroke(b("#ff6f00",y.score||0)),n.point(y.x,y.y)}),n.strokeWeight(2),r.connections.forEach(([y,o])=>{const d=r.keypoints[y],D=r.keypoints[o];d&&D&&(n.stroke(b("#ff6f00",((d.score||0)+(D.score||0))/2)),n.line(d.x,d.y,D.x,D.y))}),n.pop()}n.push(),n.noStroke(),n.translate(g,m),n.angleMode(n.DEGREES);const M=n.constrain(a.filter(h)-90,0,180),P=15,v=[180,90+P,90-P,0];M<v[1]&&M>v[2]&&console.log(M,-v[1],-v[2]);const _=1+n.map(1-Math.abs(90-n.constrain(M,v[2],v[1]))/P,0,1,0,.3);n.fill(b("#ed225d",1)),n.arc(0,0,n.width/2,n.width/2,-v[0],-v[1],n.PIE),n.fill(b("#ff6f00",1)),n.arc(0,0,n.width/2,n.width/2,-v[2],-v[3],n.PIE),n.fill(b("#0fbea0",1)),n.arc(0,0,n.width/2*_,n.width/2*_,-v[1],-v[2],n.PIE),n.pop(),n.push(),n.noStroke(),n.angleMode(n.DEGREES),n.translate(g,m),n.rotate(-M),n.fill(b("#28b2f6",.8)),n.rect(-E/2,-E/2,p,B,E),n.fill(b("#28b2f6",1)),n.ellipse(p-E,0,30),n.pop(),n.push(),n.noStroke(),n.fill("#ed225d"),n.ellipse(g,m,15),n.pop()}};return i.$$set=n=>{"class"in n&&e(0,s=n.class),"width"in n&&e(2,l=n.width),"height"in n&&e(3,w=n.height),"pose"in n&&e(4,f=n.pose),"pose3d"in n&&e(5,c=n.pose3d)},i.$$.update=()=>{if(i.$$.dirty&32&&c){const n=[c.auxHipCenter,c.auxTorsoCenter,c.auxKneeCenter];h=n.map(g=>(g==null?void 0:g.score)||1).every(g=>g>.5)?ue(...n):0}i.$$.dirty&16&&f&&(r=ce(f,f.auxHipCenter))},[s,u,l,w,f,c]}class ze extends G{constructor(t){super(),K(this,t,Re,Ae,Y,{class:0,width:2,height:3,pose:4,pose3d:5})}}function Ne(i){let t,e,a,r,s,l,w,f,c,h,u,n,b,g,m,p;re(i[9]);function B(o){i[10](o)}function E(o){i[11](o)}let M={};i[6]!==void 0&&(M.firstCond=i[6]),i[5]!==void 0&&(M.secondCond=i[5]),t=new he({props:M}),V.push(()=>W(t,"firstCond",B)),V.push(()=>W(t,"secondCond",E));function P(o){i[12](o)}let v={class:"absolute bottom-16 left-4",height:Math.floor(i[3]/3*(4/3)),width:Math.floor(i[3]/3),facingMode:"user"};i[1]!==void 0&&(v.tpCamera=i[1]),s=new de({props:v}),V.push(()=>W(s,"tpCamera",P)),s.$on("canvas-ready",i[7]),c=new pe({props:{width:Math.floor(i[3]),height:Math.floor(i[3]*(9/16)),class:"grid card h-1/3 rounded-box mx-4 mt-4 overflow-hidden"}});function _(o){i[13](o)}function S(o){i[14](o)}let y={class:"grid w-full",width:Math.floor(i[3]),height:Math.floor(i[4]-i[3]*(9/16)-36)};return i[0]!==void 0&&(y.pose=i[0]),i[2]!==void 0&&(y.pose3d=i[2]),u=new ze({props:y}),V.push(()=>W(u,"pose",_)),V.push(()=>W(u,"pose3d",S)),{c(){I(t.$$.fragment),r=Z(),I(s.$$.fragment),w=Z(),f=j("div"),I(c.$$.fragment),h=Z(),I(u.$$.fragment),this.h()},l(o){A(t.$$.fragment,o),r=J(o),A(s.$$.fragment,o),w=J(o),f=H(o,"DIV",{class:!0});var d=L(f);A(c.$$.fragment,d),h=J(d),A(u.$$.fragment,d),d.forEach(k),this.h()},h(){C(f,"class","flex flex-col w-full h-full top-0 bottom-0 bg-white")},m(o,d){R(t,o,d),Q(o,r,d),R(s,o,d),Q(o,w,d),Q(o,f,d),R(c,f,null),te(f,h),R(u,f,null),g=!0,m||(p=le(window,"resize",i[9]),m=!0)},p(o,[d]){const D={};!e&&d&64&&(e=!0,D.firstCond=o[6],O(()=>e=!1)),!a&&d&32&&(a=!0,D.secondCond=o[5],O(()=>a=!1)),t.$set(D);const X={};d&8&&(X.height=Math.floor(o[3]/3*(4/3))),d&8&&(X.width=Math.floor(o[3]/3)),!l&&d&2&&(l=!0,X.tpCamera=o[1],O(()=>l=!1)),s.$set(X);const U={};d&8&&(U.width=Math.floor(o[3])),d&8&&(U.height=Math.floor(o[3]*(9/16))),c.$set(U);const T={};d&8&&(T.width=Math.floor(o[3])),d&24&&(T.height=Math.floor(o[4]-o[3]*(9/16)-36)),!n&&d&1&&(n=!0,T.pose=o[0],O(()=>n=!1)),!b&&d&4&&(b=!0,T.pose3d=o[2],O(()=>b=!1)),u.$set(T)},i(o){g||(z(t.$$.fragment,o),z(s.$$.fragment,o),z(c.$$.fragment,o),z(u.$$.fragment,o),g=!0)},o(o){N(t.$$.fragment,o),N(s.$$.fragment,o),N(c.$$.fragment,o),N(u.$$.fragment,o),g=!1},d(o){F(t,o),o&&k(r),F(s,o),o&&k(w),o&&k(f),F(c),F(u),m=!1,p()}}}function Fe(i,t,e){let a,r;ne(i,ie,_=>e(17,_));let s,l,w,f,c,h=!1,u,n;const b=me.BlazePose;async function g(_){const S=_.detail.size;let[y,o]=await $(ge(b,s,S));o&&([l,w]=o,e(8,h=!0))}const m=new _e(30);se(async()=>(m.start(async()=>{if(!s||(await s.waitForFrame(),s.drawCtx(),!(l!=null&&l.ready)))return;const _=w.getImage(),[S,y]=await $(l.detectProcessed(_));y&&e(0,[f,c]=y,f,e(2,c))}),()=>m.stop())),fe(()=>{console.log("[InteractiveDemo] destroy"),l==null||l.dispose(),m.destroy()});function p(){e(4,n=window.innerHeight),e(3,u=window.innerWidth)}function B(_){a=_,e(6,a),e(8,h)}function E(_){r=_,e(5,r),e(0,f)}function M(_){s=_,e(1,s)}function P(_){f=_,e(0,f)}function v(_){c=_,e(2,c)}return i.$$.update=()=>{i.$$.dirty&256&&e(6,a=!h),i.$$.dirty&1&&e(5,r=!f)},[f,s,c,u,n,r,a,g,h,p,B,E,M,P,v]}class Qe extends G{constructor(t){super(),K(this,t,Fe,Ne,Y,{})}}function Ve(i){let t,e,a,r;return t=new we({props:{modes:[{text:"\u9ACB\u94F0\u94FE\u8FD0\u52A8 - \u5F39\u529B\u5E26\u8F85\u52A9",value:0},{text:"\u7AD9\u7ACB\u540E\u7F29\u4E0B\u5DF4\u53CC\u81C2\u4E0A\u62AC\u89E6\u5899",value:1}]}}),a=new Qe({}),{c(){I(t.$$.fragment),e=Z(),I(a.$$.fragment)},l(s){A(t.$$.fragment,s),e=J(s),A(a.$$.fragment,s)},m(s,l){R(t,s,l),Q(s,e,l),R(a,s,l),r=!0},p:q,i(s){r||(z(t.$$.fragment,s),z(a.$$.fragment,s),r=!0)},o(s){N(t.$$.fragment,s),N(a.$$.fragment,s),r=!1},d(s){F(t,s),s&&k(e),F(a,s)}}}class Oe extends G{constructor(t){super(),K(this,t,null,Ve,Y,{})}}export{Oe as default};
